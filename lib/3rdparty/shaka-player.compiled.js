(function(){var g={};
(function(window){var h,aa=this;function m(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Xe=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Ue=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function r(){this.aa={}}h=r.prototype;h.push=function(a,b){this.aa.hasOwnProperty(a)?this.aa[a].push(b):this.aa[a]=[b]};h.set=function(a,b){this.aa[a]=b};h.has=function(a){return this.aa.hasOwnProperty(a)};h.get=function(a){return(a=this.aa[a])?a.slice():null};function ba(a){var b=[],c;for(c in a.aa)b.push.apply(b,a.aa[c]);return b}h.remove=function(a,b){var c=this.aa[a];if(c)for(var d=0;d<c.length;++d)c[d]==b&&(c.splice(d,1),--d)};h.keys=function(){var a=[],b;for(b in this.aa)a.push(b);return a};
h.clear=function(){this.aa={}};function z(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;return c};var ca=0;function A(a){this.j=a;this.Sa=new da(a,ea);fa||(fa=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var fa;A.prototype.Ma=function(){return this.Sa.Ma()};
function B(a){var b;b=ga(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=ga(a);a:{for(d=0;d<fa.length;d++)if(ha(c,fa[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;c=
a.Sa.i+c<=a.j.byteLength?c:a.j.byteLength-a.Sa.i;d=new DataView(a.j.buffer,a.j.byteOffset+a.Sa.i,c);C(a.Sa,c);return new ia(b,d)}function ga(a){var b=ja(a.Sa),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=ja(a.Sa);return d}function ia(a,b){this.id=a;this.j=b}
function ka(a){if(8<a.j.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.j.byteLength&&a.j.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.j.byteLength;c++)var d=a.j.getUint8(c),b=256*b+d;return b};function la(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function ma(a){return String.fromCharCode.apply(null,a)}m("shaka.util.Uint8ArrayUtils.toString",ma);function na(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}m("shaka.util.Uint8ArrayUtils.fromString",na);function oa(a,b){var c=void 0==b?!0:b,d=window.btoa(ma(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}m("shaka.util.Uint8ArrayUtils.toBase64",oa);function pa(a){return na(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
m("shaka.util.Uint8ArrayUtils.fromBase64",pa);m("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function qa(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}m("shaka.util.Uint8ArrayUtils.toHex",qa);function ha(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function D(a,b){return b.bind(a)};function ra(a){return Object.keys(a).map(function(b){return a[b]})};function E(){this.$a=new r}E.prototype.destroy=function(){sa(this);this.$a=null};function F(a,b,c,d){b=new ta(b,c,d);a.$a.push(c,b)}E.prototype.Jb=function(a,b){for(var c=this.$a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.Jb(),this.$a.remove(b,e))}};function sa(a){for(var b=ba(a.$a),c=0;c<b.length;++c)b[c].Jb();a.$a.clear()}function ta(a,b,c){this.target=a;this.type=b;this.ld=c;this.target.addEventListener(b,c,!1)}
ta.prototype.Jb=function(){this.target&&(this.target.removeEventListener(this.type,this.ld,!1),this.ld=this.target=null)};function ua(){this.Pc=new z;this.qa=!1;this.ta=null;this.Ha=[];this.Ia=null}ua.prototype.append=function(a){if(this.qa)throw Error("Cannot append to a running task!");this.Ha.push(a)};ua.prototype.start=function(){if(this.qa)throw Error("Task already started!");this.qa=!0;this.Ha.unshift(function(){});va(this,void 0)};ua.prototype.abort=function(){if(this.ta)return this.ta;if(!this.qa)return this.qa=!0,Promise.resolve();this.Ia&&this.Ia();return this.ta=new z};ua.prototype.end=function(){this.Ha.splice(1)};
function va(a,b){var c=a.Ha[0](b),d;c?(d=c[0],a.Ia=c[1]):(d=Promise.resolve(),a.Ia=null);d.then(function(a){this.ta?(this.Ha=[],this.Ia=null,wa(this)):(this.Ha.shift(),this.Ha.length?va(this,a):(this.Pc.resolve(a),this.Ia=null))}.bind(a)).catch(function(){this.Ha=[];this.Ia=null;this.ta&&wa(this)}.bind(a))}function wa(a){var b=Error("Task aborted.");b.type="aborted";a.Pc.reject(b);window.setTimeout(function(){this.ta.resolve();this.ta=null}.bind(a),5)};function xa(a,b,c){ya(b);ya(c);return c==b||a>=za&&c==b.split("-")[0]||a>=Aa&&c.split("-")[0]==b.split("-")[0]?!0:!1}var za=1,Aa=2;function ya(a){a=a.toLowerCase().split("-");var b=Ba[a[0]];b&&(a[0]=b);return a.join("-")}
var Ba={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function G(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function I(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function da(a,b){this.j=a;this.Bc=b==Ca;this.i=0}var ea=0,Ca=1;da.prototype.Ma=function(){return this.i<this.j.byteLength};function ja(a){var b=a.j.getUint8(a.i);a.i+=1;return b}function J(a){var b=a.j.getUint32(a.i,a.Bc);a.i+=4;return b}function Da(a){var b,c;a.Bc?(b=a.j.getUint32(a.i,!0),c=a.j.getUint32(a.i+4,!0)):(c=a.j.getUint32(a.i,!1),b=a.j.getUint32(a.i+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.i+=8;return c*Math.pow(2,32)+b}
function Ea(a){if(a.i+16>a.j.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.j.buffer,a.i,16);a.i+=16;return b}function C(a,b){if(a.i+b>a.j.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.i+=b};function K(a){this.Ac=new r;this.parent=a}m("shaka.util.FakeEventTarget",K);K.prototype.addEventListener=function(a,b,c){c||this.Ac.push(a,b)};K.prototype.removeEventListener=function(a,b,c){c||this.Ac.remove(a,b)};K.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return Fa(this,a)};
function Fa(a,b){b.currentTarget=a;for(var c=a.Ac.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.parent&&b.bubbles&&Fa(a.parent,b);return b.defaultPrevented};function Ga(a){this.Uc=Math.exp(Math.log(.5)/a);this.mc=this.tc=0}Ga.prototype.sample=function(a,b){var c=Math.pow(this.Uc,a);this.tc=b*(1-c)+c*this.tc;this.mc+=a};function Ha(a){return a.tc/(1-Math.pow(a.Uc,a.mc))};function Ia(){K.call(this,null);this.uc=new Ga(3);this.Ad=new Ga(10);this.ae=50;this.Kd=5E5;this.be=.5;this.$d=65536;this.hd=0}q(Ia,K);m("shaka.util.EWMABandwidthEstimator",Ia);Ia.prototype.sample=function(a,b){if(!(b<this.$d)){a=Math.max(a,this.ae);var c=8E3*b/a,d=a/1E3;this.uc.sample(d,c);this.Ad.sample(d,c);this.dispatchEvent(G({type:"bandwidth"}));this.hd=Date.now()}};Ia.prototype.getBandwidth=function(){return this.uc.mc<this.be?this.Kd:Math.min(Ha(this.uc),Ha(this.Ad))};
Ia.prototype.getDataAge=function(){return(Date.now()-this.hd)/1E3};function Ja(a){this.systemIds=[];this.cencKeyIds=[];a=new da(new DataView(a.buffer),ea);try{for(;a.Ma();){var b=a.i,c=J(a),d=J(a);1==c?c=Da(a):0==c&&(c=a.j.byteLength-b);if(1886614376!=d)C(a,c-(a.i-b));else{var e=ja(a);if(1<e)C(a,c-(a.i-b));else{C(a,3);var f=qa(Ea(a)),g=[];if(0<e)for(var k=J(a),l=0;l<k;++l){var p=qa(Ea(a));g.push(p)}var n=J(a);C(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.i!=b+c&&C(a,c-(a.i-b))}}}}catch(y){}};function Ka(a){La[a]={sb:Ma(),end:NaN}}function Na(a){if(a=La[a])a.end=Ma()}function Oa(a){return(a=La[a])&&a.end?a.end-a.sb:NaN}var Ma=window.performance?window.performance.now.bind(window.performance):Date.now,La={};function Pa(){var a=HTMLVideoElement.prototype;a.getVideoPlaybackQuality||(a.getVideoPlaybackQuality=function(){return"webkitDroppedFrameCount"in this?{corruptedVideoFrames:0,droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,creationTime:null,totalFrameDelay:null}:null})}m("shaka.polyfill.VideoPlaybackQuality.install",Pa);function Qa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
Ra);document.addEventListener("webkitfullscreenerror",Ra);document.addEventListener("mozfullscreenchange",Ra);document.addEventListener("mozfullscreenerror",Ra);document.addEventListener("MSFullscreenChange",Ra);document.addEventListener("MSFullscreenError",Ra)}m("shaka.polyfill.Fullscreen.install",Qa);function Ra(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function Sa(a,b){try{var c=new Ta(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function Ua(a){var b=this.mediaKeys;b&&b!=a&&Va(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&Va(a,this);return Promise.resolve()}
function Ta(a,b){this.eb=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.eb="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],k={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes},l=!1;if(g.audioCapabilities)for(var p=0;p<g.audioCapabilities.length;++p){var n=g.audioCapabilities[p];n.contentType&&
(l=!0,e.canPlayType(n.contentType.split(";")[0],this.eb)&&(k.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(p=0;p<g.videoCapabilities.length;++p)n=g.videoCapabilities[p],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.eb)&&(k.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.eb)||e.canPlayType("video/webm",this.eb));"required"==g.persistentState&&(c?k.persistentState="required":d=!1);if(d){this.Jd=k;return}}throw Error("None of the requested configurations were supported.");
}Ta.prototype.createMediaKeys=function(){var a=new Wa(this.eb);return Promise.resolve(a)};Ta.prototype.getConfiguration=function(){return this.Jd};function Wa(a){this.Oa=a;this.Ea=null;this.l=new E;this.od=[];this.yd={}}function Va(a,b){a.Ea=b;sa(a.l);b&&(F(a.l,b,"webkitneedkey",a.ze.bind(a)),F(a.l,b,"webkitkeymessage",a.ye.bind(a)),F(a.l,b,"webkitkeyadded",a.we.bind(a)),F(a.l,b,"webkitkeyerror",a.xe.bind(a)))}h=Wa.prototype;
h.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.Ea||document.createElement("video");a.src||(a.src="about:blank");b=new Xa(a,this.Oa,b);this.od.push(b);return b};h.ze=function(a){a=G({type:"encrypted",initDataType:"webm",initData:a.initData});this.Ea.dispatchEvent(a)};
h.ye=function(a){var b=Ya(this,a.sessionId);b&&(a=G({type:"message",messageType:void 0==b.keyStatuses.ra?"licenserequest":"licenserenewal",message:a.message}),b.$&&(b.$.resolve(),b.$=null),b.dispatchEvent(a))};h.we=function(a){(a=Ya(this,a.sessionId))&&a.ready()};h.xe=function(a){var b=Ya(this,a.sessionId);b&&b.handleError(a)};function Ya(a,b){var c=a.yd[b];return c?c:(c=a.od.shift())?(c.sessionId=b,a.yd[b]=c):null}
function Xa(a,b,c){K.call(this,null);this.Ea=a;this.fd=!1;this.Q=this.$=null;this.Oa=b;this.nc=c;this.sessionId="";this.expiration=NaN;this.closed=new z;this.keyStatuses=new Za}q(Xa,K);h=Xa.prototype;h.ready=function(){$a(this,"usable");this.Q&&this.Q.resolve();this.Q=null};
h.handleError=function(a){var b=Error("EME v0.1b key error");b.errorCode=a.errorCode;b.errorCode.systemCode=a.systemCode;!a.sessionId&&this.$?(b.method="generateRequest",45==a.systemCode&&(b.message="Unsupported session type."),this.$.reject(b),this.$=null):a.sessionId&&this.Q?(b.method="update",this.Q.reject(b),this.Q=null):(b=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?$a(this,"output-not-allowed"):1==b?$a(this,"expired"):$a(this,"internal-error"))};
function ab(a,b,c){if(a.fd)return Promise.reject(Error("The session is already initialized."));a.fd=!0;try{var d;if("persistent-license"==a.nc)if(c)d=na("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=na("PERSISTENT|"+ma(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.$=new z;try{a.Ea.webkitGenerateKeyRequest(a.Oa,d)}catch(g){if("InvalidStateError"!=g.name)return a.$=null,Promise.reject(g);setTimeout(function(){try{this.Ea.webkitGenerateKeyRequest(this.Oa,d)}catch(a){this.$.reject(a),
this.$=null}}.bind(a),10)}return a.$}
h.Sc=function(a,b){if(this.Q)this.Q.then(this.Sc.bind(this,a,b)).catch(this.Sc.bind(this,a,b));else{this.Q=a;var c,d;if("webkit-org.w3.clearkey"==this.Oa){c=ma(new Uint8Array(b));d=JSON.parse(c);c=d.keys[0].kty;if("A128KW"!=d.keys[0].alg||"oct"!=c)this.Q.reject(Error("Response is not a valid JSON Web Key Set.")),this.Q=null;c=pa(d.keys[0].k);d=pa(d.keys[0].kid)}else c=new Uint8Array(b),d=null;try{this.Ea.webkitAddKey(this.Oa,c,d,this.sessionId)}catch(e){this.Q.reject(e),this.Q=null}}};
function $a(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.ra=b;c=G({type:"keystatuseschange"});a.dispatchEvent(c)}h.generateRequest=function(a,b){return ab(this,b,null)};h.load=function(a){return"persistent-license"==this.nc?ab(this,null,a):Promise.reject(Error("Not a persistent session."))};h.update=function(a){var b=new z;this.Sc(b,a);return b};
h.close=function(){if("persistent-license"!=this.nc){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.Ea.webkitCancelKeyRequest(this.Oa,this.sessionId)}this.closed.resolve();return this.closed};h.remove=function(){return"persistent-license"!=this.nc?Promise.reject(Error("Not a persistent session.")):this.close()};function bb(a){this.Ed=a;this.dd=0}
bb.prototype.next=function(){return this.dd>=this.Ed.length?{value:void 0,done:!0}:{value:this.Ed[this.dd++],done:!1}};function Za(){this.size=0;this.ra=void 0}var cb;h=Za.prototype;h.forEach=function(a){this.ra&&a(this.ra)};h.get=function(a){if(this.has(a))return this.ra};h.has=function(a){var b=cb;return this.ra&&ha(new Uint8Array(a),b)?!0:!1};h.keys=function(){var a=cb,b=[];this.ra&&b.push(a);return new bb(b)};h.values=function(){var a=[];this.ra&&a.push(this.ra);return new bb(a)};function db(){return Promise.reject(Error("The key system specified is not supported."))}function eb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function fb(){throw new TypeError("Illegal constructor.");}fb.prototype.createSession=function(){};function gb(){throw new TypeError("Illegal constructor.");}gb.prototype.getConfiguration=function(){};gb.prototype.createMediaKeys=function(){};function hb(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(cb=na("FAKE_KEY_ID"),Navigator.prototype.requestMediaKeySystemAccess=Sa,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ua,window.MediaKeys=Wa,window.MediaKeySystemAccess=Ta):(Navigator.prototype.requestMediaKeySystemAccess=db,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=eb,window.MediaKeys=fb,window.MediaKeySystemAccess=gb))}m("shaka.polyfill.MediaKeys.install",hb);function ib(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=jb)}m("shaka.polyfill.CustomEvent.install",ib);function jb(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};m("shaka.polyfill.installAll",function(){ib();Qa();hb();Pa()});function kb(a,b,c,d,e,f,g,k){this.keySystem=a;this.Xd=b;this.withCredentials=c;this.Na=[];this.jd=e||null;this.kd=f||null;this.Ld=g==lb;this.Ae=k==mb;d&&this.Na.push(d)}m("shaka.player.DrmSchemeInfo",kb);var lb=1;kb.DistinctiveIdentifier={Fd:0,Gd:lb};var mb=1;kb.PersistentState={Fd:0,Gd:mb};function nb(a){this.body=a;this.headers={}}function ob(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}
ob.prototype.clone=function(){var a=new ob;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function pb(){return new kb("","",!1,null)}kb.createUnencrypted=pb;function qb(a,b){a.Na=la(a.Na.concat(b.Na),function(a){return Array.prototype.join.apply(a.initData)})}kb.combine=qb;kb.prototype.key=function(){return JSON.stringify(this)};function rb(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function sb(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}m("shaka.player.VideoTrack.compare",sb);function tb(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}m("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ub(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}m("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});var vb=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function L(a){var b;a instanceof L?(wb(this,a.Fa),this.Ya=a.Ya,this.ma=a.ma,xb(this,a.mb),this.fa=a.fa,yb(this,a.Ra.clone()),this.La=a.La):a&&(b=String(a).match(vb))?(wb(this,b[1]||"",!0),this.Ya=zb(b[2]||""),this.ma=zb(b[3]||"",!0),xb(this,b[4]),this.fa=zb(b[5]||"",!0),yb(this,b[6]||"",!0),this.La=zb(b[7]||"")):this.Ra=new Ab(null)}h=L.prototype;h.Fa="";h.Ya="";h.ma="";h.mb=null;h.fa="";h.La="";
h.toString=function(){var a=[],b=this.Fa;b&&a.push(Bb(b,Cb,!0),":");if(b=this.ma){a.push("//");var c=this.Ya;c&&a.push(Bb(c,Cb,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.mb;null!=b&&a.push(":",String(b))}if(b=this.fa)this.ma&&"/"!=b.charAt(0)&&a.push("/"),a.push(Bb(b,"/"==b.charAt(0)?Db:Eb,!0));(b=this.Ra.toString())&&a.push("?",b);(b=this.La)&&a.push("#",Bb(b,Fb));return a.join("")};
h.resolve=function(a){var b=this.clone(),c=!!a.Fa;c?wb(b,a.Fa):c=!!a.Ya;c?b.Ya=a.Ya:c=!!a.ma;c?b.ma=a.ma:c=null!=a.mb;var d=a.fa;if(c)xb(b,a.mb);else if(c=!!a.fa){if("/"!=d.charAt(0))if(this.ma&&!this.fa)d="/"+d;else{var e=b.fa.lastIndexOf("/");-1!=e&&(d=b.fa.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var k=d[g++];"."==k?e&&g==d.length&&f.push(""):".."==k?((1<f.length||1==f.length&&
""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(k),e=!0)}d=f.join("/")}}c?b.fa=d:c=""!==a.Ra.toString();c?yb(b,a.Ra.clone()):c=!!a.La;c&&(b.La=a.La);return b};h.clone=function(){return new L(this)};function wb(a,b,c){a.Fa=c?zb(b,!0):b;a.Fa&&(a.Fa=a.Fa.replace(/:$/,""))}function xb(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.mb=b}else a.mb=null}function yb(a,b,c){b instanceof Ab?a.Ra=b:(c||(b=Bb(b,Gb)),a.Ra=new Ab(b))}
function zb(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Bb(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Hb),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Hb(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Cb=/[#\/\?@]/g,Eb=/[\#\?:]/g,Db=/[\#\?]/g,Gb=/[\#\?@]/g,Fb=/#/g;function Ab(a){this.xa=a||null}h=Ab.prototype;h.S=null;h.Qb=null;
h.add=function(a,b){if(!this.S&&(this.S={},this.Qb=0,this.xa))for(var c=this.xa.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("="),f=null,g=null;0<=e?(f=c[d].substring(0,e),g=c[d].substring(e+1)):f=c[d];f=decodeURIComponent(f.replace(/\+/g," "));g=g||"";this.add(f,decodeURIComponent(g.replace(/\+/g," ")))}this.xa=null;(c=this.S.hasOwnProperty(a)&&this.S[a])||(this.S[a]=c=[]);c.push(b);this.Qb++;return this};
h.toString=function(){if(this.xa)return this.xa;if(!this.S)return"";var a=[],b;for(b in this.S)for(var c=encodeURIComponent(b),d=this.S[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.xa=a.join("&")};h.clone=function(){var a=new Ab;a.xa=this.xa;if(this.S){var b={},c;for(c in this.S)b[c]=this.S[c].concat();a.S=b;a.Qb=this.Qb}return a};function M(a,b,c,d,e){this.startTime=a;this.endTime=b;this.Wa=c;this.wb=d;this.url=e}function Ib(a,b,c){return new M(b,c,a.Wa,a.wb,a.url)}function Jb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.startTime&&(null==d.endTime||b<d.endTime))return c}return-1};function Kb(){}Kb.prototype.parse=function(a,b,c){var d=null;try{d=this.Kc(a,b,c)}catch(e){if(!(e instanceof RangeError))throw e;}return d};
Kb.prototype.Kc=function(a,b,c){b=new A(b);if(440786851!=B(b).id)b=null;else{var d=B(b);if(408125543!=d.id)b=null;else{b=d.j.byteOffset;for(var d=new A(d.j),e=null;d.Ma();){var f=B(d);if(357149030==f.id){e=f;break}}if(e){d=new A(e.j);for(e=1E6;d.Ma();)if(f=B(d),2807729==f.id){e=ka(f);break}d=e/1E9}else d=null;b=d?{Fe:b,Qe:d}:null}}if(!b)return null;e=B(new A(a));if(475249515!=e.id)return null;a=b.Fe;b=b.Qe;for(var d=[],e=new A(e.j),g=f=-1;e.Ma();){var k=B(e);if(187==k.id){var l;l=new A(k.j);k=B(l);
if(179!=k.id)l=null;else if(k=ka(k),l=B(l),183!=l.id)l=null;else{l=new A(l.j);for(var p=0;l.Ma();){var n=B(l);if(241==n.id){p=ka(n);break}}l={Se:k,Be:p}}l&&(k=b*l.Se,l=a+l.Be,0<=f&&d.push(new M(f,k,g,l-1,c)),f=k,g=l)}}0<=f&&d.push(new M(f,null,g,null,c));return d};function N(a){this.f=a;this.ja=0}N.prototype.destroy=function(){this.f=null};h=N.prototype;h.length=function(){return this.f.length};h.first=function(){if(0==this.f.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return this.f[0]};function O(a){if(0==a.f.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.f[a.f.length-1]}
h.get=function(a){if(0>a||a>=this.f.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.f[a]};h.find=function(a){a=Jb(this.f,a);return 0<=a?this.f[a]:null};h.gd=function(a){Lb(this,a);return!0};
function Lb(a,b){a.ja!=b.ja&&(b=new N(Mb(b.f,a.ja-b.ja)));if(0==a.length())a.f=b.f.slice(0);else if(0!=b.length()&&null!=O(a).endTime&&!(null!=O(b).endTime&&O(b).endTime<O(a).endTime)){if(O(a).endTime<=b.first().startTime)var c=Ib(O(a),O(a).startTime,b.first().startTime),c=a.f.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.f.length&&!(a.f[d].endTime>=b.first().startTime);++d);a.f[d].startTime<b.first().startTime?(c=Ib(a.f[d],a.f[d].startTime,b.first().startTime),c=a.f.slice(0,d).concat([c])):(a.first().startTime>
b.first().startTime||b.first(),c=a.f.slice(0,d))}a.f=c.concat(b.f)}}function Nb(a,b){var c=b-a.ja;0!=c&&(a.f=Mb(a.f,c),a.ja=b)}function Mb(a,b){return a.map(function(a){return Ib(a,a.startTime+b,null!=a.endTime?a.endTime+b:null)})};function Ob(a){this.Pe=a;this.c=null}Ob.prototype.destroy=function(){this.c&&(this.c.destroy(),this.c=null)};Ob.prototype.create=function(){if(this.c)return Promise.resolve(this.c);var a=new M(0,null,0,null,this.Pe);this.c=new N([a]);return Promise.resolve(this.c)};function Pb(){}Pb.prototype.parse=function(a,b,c){var d=null;try{d=this.Kc(a,b,c)}catch(e){if(!(e instanceof RangeError))throw e;}return d};
Pb.prototype.Kc=function(a,b,c){var d=[];a=new da(a,ea);var e=J(a);if(1936286840!=J(a))return null;1==e&&(e=Da(a));var f=ja(a);C(a,3);C(a,4);var g=J(a);if(0==g)return null;var k,l;0==f?(k=J(a),l=J(a)):(k=Da(a),l=Da(a));C(a,2);f=a.j.getUint16(a.i,a.Bc);a.i+=2;b=b+e+l;for(e=0;e<f;e++){var p=J(a);l=(p&2147483648)>>>31;var p=p&2147483647,n=J(a);J(a);if(1==l)return null;d.push(new M(k/g,(k+n)/g,b,b+p-1,c));k+=n;b+=p}return d};function Qb(a){this.url=a;this.h=new Rb;this.Gb=this.Bd=this.rc=0;this.m=null;this.B=new z;this.N=null}function Rb(){this.body=null;this.Ab=1;this.Wc=1E3;this.De=2;this.Ee=.5;this.Zb=0;this.method="GET";this.responseType="arraybuffer";this.Yb={};this.Cd=this.withCredentials=!1}function Sb(a){Tb(a);a.h.body=null;a.B=null;a.N=null}function Tb(a){a.m&&(a.m.onload=null,a.m.onreadystatechange=null,a.m.onerror=null,a.m.ontimeout=null);a.m=null}h=Qb.prototype;
h.fc=function(){if(this.m)return this.B;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.h.responseType&&(b=na(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.B;b.resolve(a);Sb(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Ub(this);this.rc++;this.Bd=Date.now();
this.Gb||(this.Gb=this.h.Wc);this.m=new XMLHttpRequest;a=this.url;this.N&&(a=new L(a),a.Ra.add("_",Date.now()),a=a.toString());this.m.open(this.h.method,a,!0);this.m.responseType=this.h.responseType;this.m.timeout=this.h.Zb;this.m.withCredentials=this.h.withCredentials;this.m.onload=this.ge.bind(this);this.h.Cd&&(this.m.onreadystatechange=this.le.bind(this));this.m.onerror=this.Gc.bind(this);this.m.ontimeout=this.te.bind(this);for(b in this.h.Yb)this.m.setRequestHeader(b,this.h.Yb[b]);this.m.send(this.h.body);
return this.B};function Ub(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Vb(null,null);return Wb(e).then(function(){return Xb(e,c,d)}).then(D(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.B;a.resolve(b);P(e);Sb(this);return a})).catch(D(a,function(a){P(e);Sb(this);return Promise.reject(a)}))}function Yb(a,b,c){b=Error(b);b.type=c;b.status=a.m.status;b.url=a.url;b.method=a.h.method;b.body=a.h.body;b.Te=a.m;return b}
h.abort=function(){if(this.m&&this.m.readyState!=XMLHttpRequest.DONE){this.m.abort();var a=Yb(this,"Request aborted.","aborted");this.B.reject(a);Sb(this)}};h.ge=function(a){this.N&&this.N.sample(Date.now()-this.Bd,a.loaded);200<=this.m.status&&299>=this.m.status?(this.B.resolve(this.m),Sb(this)):this.rc<this.h.Ab?Zb(this):(a=Yb(this,"HTTP error.","net"),this.B.reject(a),Sb(this))};
h.le=function(){if(this.m.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.m.getResponseHeader("Date"));a&&(ca=a-Date.now())}};h.Gc=function(){var a=Yb(this,"Network failure.","net");this.B.reject(a);Sb(this)};h.te=function(){if(this.rc<this.h.Ab)Zb(this);else{var a=Yb(this,"Request timmedout.","net");this.B.reject(a);Sb(this)}};function Zb(a){Tb(a);window.setTimeout(a.fc.bind(a),a.Gb*(1+(2*Math.random()-1)*a.h.Ee));a.Gb*=a.h.De};function $b(a,b,c,d,e){Qb.call(this,a);if(b||c)this.h.Yb.Range="bytes="+(b+"-"+(null!=c?c:""));d&&(this.h.Ab=d);e&&(this.h.Wc=e);this.h.Zb=ac}q($b,Qb);var ac=0;$b.prototype.send=function(){return this.fc().then(D(this,function(a){return Promise.resolve(a.response)}))};function bc(a,b,c){this.url=a;this.Wa=b;this.wb=c;this.nb=this.Ua=null}bc.prototype.xb=function(){if(this.nb)return this.nb;this.Ua=new $b(this.url.toString(),this.Wa,this.wb);var a=this.Ua.send().then(D(this,function(a){this.Ua=null;return Promise.resolve(a)}));return this.nb=a=a.catch(D(this,function(a){this.nb=this.Ua=null;return Promise.reject(a)}))};function cc(a){a.Ua&&(a.Ua.abort(),a.Ua=null,a.nb=null)};function dc(a,b,c){this.md=a;this.Ga=b;this.O=c;this.l=new E;this.Ba=[];this.Pa=this.C=this.Yc=null;F(this.l,this.Ga,"updateend",this.qe.bind(this))}var ec=1/60;dc.prototype.destroy=function(){this.abort();this.Ba=this.C=this.Pa=null;this.l.destroy();this.md=this.Ga=this.l=null};function fc(a,b){for(var c=a.Ga.buffered,d=0;d<c.length;++d){var e=c.start(d)-ec,f=c.end(d)+ec;if(b>=e&&b<=f)return c.end(d)-b}return 0}h=dc.prototype;
h.xb=function(a,b){if(this.C){var c=Error("Cannot fetch: previous operation not complete.");c.type="stream";return Promise.reject(c)}this.C=new ua;b&&this.C.append(function(){return[gc(this,b),this.pc.bind(this)]}.bind(this));this.C.append(function(){var b=new $b(a.url.toString(),a.Wa,a.wb,3,1E3*(a.endTime?a.endTime-a.startTime:1));b.N=this.O;return[b.send(),b.abort.bind(b)]}.bind(this));this.C.append(function(a){this.O.getBandwidth();return[gc(this,a),this.pc.bind(this)]}.bind(this));var d=null;
this.C.append(function(){var b=a;null==this.Yc&&(b=a.startTime,d=this.Ga.buffered.start(0)-b,b=Ib(a,a.startTime+d,null!=a.endTime?a.endTime+d:null),this.Yc=d);var c=Jb(this.Ba,a.startTime);0<=c?this.Ba.splice(c+1,0,b):this.Ba.push(b)}.bind(this));return hc(this).then(function(){return Promise.resolve(d)}.bind(this))};
h.clear=function(){if(this.C){var a=Error("Cannot clear: previous operation not complete.");a.type="stream";return Promise.reject(a)}this.C=new ua;this.C.append(function(){var a;a:if(0==this.Ga.buffered.length)a=Promise.resolve();else{try{this.Ga.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.Ba=[];a=this.Pa=new z}return[a,this.pc.bind(this)]}.bind(this));return hc(this)};h.abort=function(){return this.C?this.C.abort():Promise.resolve()};
function hc(a){a.C.start();return a.C.Pc.then(function(){this.C=null}.bind(a)).catch(function(a){this.C=null;return Promise.reject(a)}.bind(a))}function gc(a,b){try{a.Ga.appendBuffer(b)}catch(c){return Promise.reject(c)}a.Pa=new z;return a.Pa}h.pc=function(){"open"==this.md.readyState&&this.Ga.abort()};h.qe=function(){this.Pa.resolve();this.Pa=null};function ic(a){this.Db=a}ic.prototype.destroy=function(){this.Db&&(cc(this.Db),this.Db=null)};ic.prototype.create=function(){return this.Db?this.Db.xb():Promise.resolve(null)};function jc(){this.I=kc++;this.id=this.H=this.G=null;this.timestampOffset=0;this.height=this.width=this.bandwidth=null;this.Y=this.n="";this.enabled=!0}var kc=0;jc.prototype.destroy=function(){this.G&&(this.G.destroy(),this.G=null);this.H&&(this.H.destroy(),this.H=null)};function lc(a){var b=a.n||"";a.Y&&(b+='; codecs="'+a.Y+'"');return b}function mc(){this.I=nc++;this.id=null;this.contentType="";this.e=[];this.Ja=[];this.lang="";this.yb=!1}var nc=0;
mc.prototype.destroy=function(){for(var a=0;a<this.e.length;++a)this.e[a].destroy();this.Ja=this.e=null};mc.prototype.wc=function(){for(var a=[],b=0;b<this.Ja.length;++b){var c=new oc;c.id=this.I;c.Z=this.Ja[b];c.contentType=this.contentType;c.ya=this.e.length?lc(this.e[0]):"";a.push(c)}return a};function pc(){this.id=null;this.start=0;this.duration=null;this.u=[]}pc.prototype.wc=function(){for(var a=[],b=0;b<this.u.length;++b)a.push.apply(a,this.u[b].wc());return a};
pc.prototype.destroy=function(){for(var a=0;a<this.u.length;++a)this.u[a].destroy();this.u=null};function qc(){this.Da=!1;this.Lb=this.Kb=null;this.ba=0;this.t=[]}qc.prototype.destroy=function(){for(var a=0;a<this.t.length;++a)this.t[a].destroy();this.t=null};function oc(){this.id=0;this.Z=null;this.ya=this.contentType=""};function rc(a,b){K.call(this,a);this.a=b;this.vb=!0;this.ka=this.L=null}q(rc,K);rc.prototype.destroy=function(){this.ka&&this.a.removeChild(this.ka);this.parent=this.a=this.L=this.ka=null};h=rc.prototype;h.cd=function(){return!0};h.bd=function(){return!0};
h.kc=function(a){this.L=a;a.G.create().then(D(this,function(a){if(this.a){if(0==a.length())return Promise.reject(Error("No subtitles URL available."));a=a.first().url.toString();var c=this.xc();this.ka&&(this.hc(!1),this.a.removeChild(this.ka));this.ka=document.createElement("track");this.a.appendChild(this.ka);this.ka.src=a;this.hc(c)}}))};h.xd=function(){};h.hc=function(a){this.vb=a;this.ka&&(this.ka.track.mode=a?"showing":"disabled")};h.xc=function(){return this.vb};function sc(a,b,c,d,e){K.call(this,a);this.a=b;this.ga=new dc(c,d,e);this.O=e;this.ed=this.c=this.L=null;this.Oc=!1;this.R=null;this.Dc=this.Rb=this.qa=this.Fb=!1}q(sc,K);var tc=15;sc.prototype.destroy=function(){this.Ob();this.O=this.L=null;this.ga.destroy();this.parent=this.a=this.ga=null};h=sc.prototype;h.cd=function(){return this.qa};h.bd=function(){return this.Rb};
h.kc=function(a,b){if(a!=this.L){var c=[a.G.create(),a.H.create()];Promise.all(c).then(D(this,function(c){var e=this.L;this.L=a;this.c=c[0];this.ed=c[1];this.Oc=!0;this.Fb||(e?b&&uc(this,!0):this.ha(0))})).catch(D(this,function(a){"aborted"!=a.type&&(a=I(a),this.dispatchEvent(a))}))}};h.xd=function(){return uc(this,!1)};
function uc(a,b){a.L&&!a.Fb&&(a.Fb=!0,a.Ob(),a.ga.abort().then(D(a,function(){var a=this.a.currentTime;if(!b&&0<fc(this.ga,a)&&0<=Jb(this.ga.Ba,a))return Promise.resolve();this.Dc=!0;return this.ga.clear()})).then(D(a,function(){this.Fb=!1;this.ha(0)})).catch(D(a,function(a){this.Fb=!1;a=I(a);this.dispatchEvent(a)})))}h.hc=function(){};h.xc=function(){return!0};
h.Jc=function(){this.R=null;var a=this.L,b=this.a.currentTime,c=fc(this.ga,b);if(c>=tc){var d=Math.abs(this.a.playbackRate);this.ha(1E3*(0!=d?(c-tc)/d:1))}else if(c=vc(this,b,this.c)){var e=this.Oc;this.ga.xb(c,this.ed).then(D(this,function(c){this.Rb=!1;this.qa||(this.qa=!0,c=G({type:"started",bubbles:!1,ja:c}),this.dispatchEvent(c));e&&(this.Oc=!1,c=a.n.split("/")[0],c=G({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:a.width,height:a.height},bandwidth:a.bandwidth}),this.dispatchEvent(c));
this.Dc&&0<fc(this.ga,b)&&(this.Dc=!1,this.a.currentTime+=.001);this.ha(0)})).catch(D(this,function(a){if("aborted"!=a.type){var b=I(a);this.dispatchEvent(b);b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Te.status)&&this.ha(5E3)}}))}else this.Rb||(this.Rb=!0,wc(this)),this.ha(1E3)};function vc(a,b,c){a=a.ga;var d=a.Ba.length;a=0<d?a.Ba[d-1]:null;return null!=a?null!=a.endTime?c.find(a.endTime):null:c.find(b)}function wc(a){var b=G({type:"ended"});a.dispatchEvent(b)}
h.ha=function(a){this.R=window.setTimeout(this.Jc.bind(this),a)};h.Ob=function(){null!=this.R&&(window.clearTimeout(this.R),this.R=null)};function xc(a,b,c,d){Qb.call(this,a);this.h.body=b;this.h.method="POST";this.h.Ab=3;this.h.withCredentials=c;this.h.Zb=yc;a=d||{};for(var e in a)this.h.Yb[e]=a[e]}q(xc,Qb);var yc=0;xc.prototype.send=function(){return this.fc().then(function(a){return Promise.resolve(new Uint8Array(a.response))})};function zc(a,b,c){K.call(this,a);this.a=b;this.b=c;this.M=this.Bb=null;this.l=new E;this.Eb={};this.pb=[];this.pd=0;this.Za=new z;this.Tc=null}q(zc,K);zc.prototype.destroy=function(){this.parent=null;for(var a=0;a<this.pb.length;++a)this.pb[a].close().catch(function(){});this.pb=[];this.Eb=this.M=this.Bb=null;this.l.destroy();this.a=this.b=this.l=null};
function Ac(a){for(var b=new r,c=a.b.Zc(),d=0;d<c.length;++d){var e=c[d];e.Z.keySystem||e.ya&&!Bc(e.ya)||b.push(e.contentType,e)}for(var d={},e=!1,f=0;f<c.length;++f){var g=c[f];if(g.Z.keySystem&&!b.has(g.contentType)){var k=g.Z.keySystem,l=d[k];l||(l=g.Z,l={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:l.Ld?"required":"optional",persistentState:l.Ae||a.b.Wb()?"required":"optional"},d[k]=l);g.ya&&(k=g.contentType+"Capabilities",k in l&&(e=!0,l[k]||(l[k]=
[]),l[k].push({contentType:g.ya,robustness:g.Z[g.contentType+"Robustness"]})))}}if(!e)if(c.length)a.M=c[0].Z;else throw a=Error("No DRM scheme info provided!"),a.type="drm",a;if(0==Object.keys(d).length)return a.b.Mc(b),a.Za.resolve(),Promise.resolve();e=new z;d=Cc(d,e);d=d.then(a.Id.bind(a,c,b));d=d.then(a.Ne.bind(a));e.reject(null);return d}
function Dc(a,b){null==a.Tc&&(a.Tc=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.Za.reject(a)}.bind(a),b));return a.Za}function Cc(a,b){for(var c in a){var d=a[c];b=b.catch(function(){return navigator.requestMediaKeySystemAccess(c,[d])})}return b}h=zc.prototype;
h.Id=function(a,b,c){for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var k=f[g];if(!b.has(k)){var l=e[k+"Capabilities"];if(l&&l.length){for(var l=l[0],p=[],n=0;n<a.length;++n){var y=a[n];if(y.Z.keySystem==d&&y.ya==l.contentType){p.push(y);this.M?qb(this.M,y.Z):this.M=y.Z;break}}b.set(k,p)}}}this.b.Mc(b);return c.createMediaKeys()};
h.Ne=function(a){this.Bb=a;return this.a.setMediaKeys(this.Bb).then(D(this,function(){if(0<this.b.Sb().length)Ec(this);else{for(var a=0;a<this.M.Na.length;++a){var c=this.M.Na[a];this.qd({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.M.Na.length&&F(this.l,this.a,"encrypted",this.qd.bind(this))}}))};
h.qd=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.Eb[c]){try{var d=Fc(this)}catch(e){d=I(e);this.dispatchEvent(d);this.Za.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.Eb[c]=!0;a.catch(D(this,function(a){if(this.Eb){this.Eb[c]=!1;var b=I(a);this.dispatchEvent(b);this.Za.reject(a)}}));this.pb.push(d)}};
function Ec(a){for(var b=a.b.Sb(),c=0;c<b.length;++c){var d=Fc(a),e=d.load(b[c]);a.pb.push(d);e.catch(D(a,function(a){a=I(a);this.dispatchEvent(a)}))}}function Fc(a){var b=a.b.Wb()?a.Bb.createSession("persistent-license"):a.Bb.createSession();F(a.l,b,"message",a.oe.bind(a));F(a.l,b,"keystatuseschange",a.fe.bind(a));return b}h.oe=function(a){Gc(this,a.target,this.M,a.message)};
h.fe=function(a){var b=a.target.keyStatuses.values();for(a=b.next();!a.done;a=b.next()){var c=Hc[a.value];c&&(c=Error(c),c.type=a.value,a=I(c),this.dispatchEvent(a))}};
function Gc(a,b,c,d){d=new nb(d);c.kd&&c.kd(d);(new xc(c.Xd,d.body,c.withCredentials,d.headers)).send().then(D(a,function(a){c.jd&&(a=c.jd(a));return b.update(a)})).then(D(a,function(){var a=G({type:"sessionReady",detail:b});this.dispatchEvent(a);this.pd++;this.pd>=this.pb.length&&this.Za.resolve()})).catch(D(a,function(a){a.Ve=b;a=I(a);this.dispatchEvent(a)}))}
var Hc={"output-not-allowed":"The required output protection is not available.",expired:"A required key has expired and the content cannot be decrypted.","internal-error":"An unknown error has occurred in the CDM."};function Vb(a,b){K.call(this,b);this.wa=null;this.O=a}q(Vb,K);
function Wb(a){if(!window.indexedDB)return Promise.reject(Error("Offline storage requires IndexedDB support."));var b=new z,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=D(a,function(a){this.wa=a.target.result;Ic(this,"group_store",{keyPath:"group_id"});Ic(this,"stream_index_store",{keyPath:"stream_id"});a=Ic(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=D(a,
function(a){this.wa=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function P(a){a.wa&&a.wa.close()}function Ic(a,b,c){a.wa.objectStoreNames.contains(b)&&a.wa.deleteObjectStore(b);return a.wa.createObjectStore(b,c)}
function Jc(a,b,c,d,e){for(var f=[],g=[],k=0,l=0,p=[],n=b.map(function(a){return a.G.create()}),n=Promise.all(n),y=b.map(function(a){return a.H.create()}),y=Promise.all(y),n=Promise.all([n,y]).then(function(a){f=a[0];g=a[1];k=f.reduce(function(a,b){return a+b.length()},0)}),y=0;y<b.length;++y)n=n.then(function(a){return Kc(this,b[a],f[a],g[a],k,l)}.bind(a,y)),n=n.then(function(a,b){l+=f[a].length();p.push(b)}.bind(a,y));return n.then(D(a,function(){return Lc(Mc(this))})).then(D(a,function(a){var b=
new z,f={group_id:a,stream_ids:p,session_ids:c,duration:d,key_system:e.keySystem},g=Mc(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function Kc(a,b,c,d,e,f){var g=[Lc(Nc(a)),Lc(Oc(a).index("stream"))],g=Promise.all(g).then(D(a,function(a){return{Ib:Math.max(a[0],a[1]),ob:new ArrayBuffer(0),Lc:0,f:[],vc:null,Re:e,wd:f}})),g=g.then(a.Ud.bind(a,c));return g=g.then(a.Vd.bind(a,b,d))}
function Lc(a){var b=new z,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}h=Vb.prototype;h.Vd=function(a,b,c){var d=new z;a={stream_id:c.Ib,mime_type:a.n,codecs:a.Y,init_segment:b,references:c.f};var e=Nc(this).put(a);e.onsuccess=function(){d.resolve(c.Ib)};e.onerror=function(){d.reject(e.error)};return d};
h.Ud=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=this.Hd.bind(this,e,b),c=c.then(this.Ce.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(D(this,function(a){Pc(this,b.Ib);return Promise.reject(a)}))};
h.Hd=function(a,b,c){var d=new z;0==b.ob.byteLength&&(b.vc=a);b.ob=Qc(b.ob,c);b.wd++;var e=G({type:"progress",detail:b.wd/b.Re*100,bubbles:!0});if(1048576<=b.ob.byteLength||null==a.endTime){c={stream_id:b.Ib,segment_id:b.Lc,content:b.ob};var f=Oc(this).put(c);b.f.push({start_time:b.vc.startTime,start_byte:b.vc.Wa,end_time:a.endTime,url:"idb://"+b.Ib+"/"+b.Lc});b.Lc++;b.ob=new ArrayBuffer(0);f.onerror=function(){d.reject(f.error)};f.onsuccess=D(this,function(){this.dispatchEvent(e);d.resolve()})}else this.dispatchEvent(e),
d.resolve();return d};function Qc(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}h.Ce=function(a){a=new $b(a.url.toString(),a.Wa,a.wb);a.N=this.O;return a.send()};function Xb(a,b,c){return Rc(Oc(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})}function Sc(a,b){return Rc(Nc(a),b)}
function Tc(a,b){return Rc(Mc(a),b).then(function(a){return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Sc(this,a.We[0]).then(function(b){a.duration=b.duration;a.Wd=b.Wd;return Promise.resolve(a)})}.bind(a))}function Uc(a){var b=new z,c=[],d=Mc(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Rc(a,b){var c=new z,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c}
function Pc(a,b){var c=new z,d=Nc(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Oc(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c}h.sc=function(a){return Tc(this,a).then(D(this,function(b){var c=[],d;for(d in b.stream_ids)c.push(Pc(this,b.stream_ids[d]));b=Mc(this);c.push(b.delete(a));return Promise.all(c)}))};
function Oc(a){return Vc(a,"content_store")}function Nc(a){return Vc(a,"stream_index_store")}function Mc(a){return Vc(a,"group_store")}function Vc(a,b){return a.wa.transaction([b],"readwrite").objectStore(b)};function Wc(a){this.cc=a;this.c=null}Wc.prototype.destroy=function(){this.cc=null;this.c&&(this.c.destroy(),this.c=null)};Wc.prototype.create=function(){if(this.c)return Promise.resolve(this.c);for(var a=[],b=0;b<this.cc.length;++b){var c=this.cc[b];a.push(new M(c.start_time,c.end_time,c.start_byte,null,new L(c.url)))}this.cc=null;this.c=new N(a);return Promise.resolve(this.c)};function Xc(a,b,c){this.P=a;this.ca=b;this.D=c;this.c=null}Xc.prototype.destroy=function(){this.D=this.ca=this.P=null;this.c&&(this.c.destroy(),this.c=null)};Xc.prototype.create=function(){if(this.c)return Promise.resolve(this.c);for(var a=this.D.A,b=0,c=[],d=0;d<a.Va.length;++d){var e=a.Va[d],b=0==d?0:b,f=null,g=null,k=b/a.p;a.q&&(f=b+a.q,g=f/a.p);var b=f,f=0,l=null;e.ib&&(f=e.ib.sb,l=e.ib.end);c.push(new M(k,g,f,l,new L(e.Cb)))}this.c=new N(c);return Promise.resolve(this.c)};function Q(a,b,c,d){N.call(this,a);this.Xb=b;this.Yd=d;this.vd=d-(b.va+c.start);this.R=window.setInterval(this.Jc.bind(this),1E3);Yc(this,this.vd)}q(Q,N);Q.prototype.destroy=function(){this.Xb=null;window.clearInterval(this.R);N.prototype.destroy.call(this)};Q.prototype.Jc=function(){this.Ic((Date.now()+ca)/1E3)};Q.prototype.Ic=function(a){Yc(this,a)};
function Yc(a,b){if(null!=a.Xb.Xa){for(var c=a.vd+(b-a.Yd),d=0,e=0;e<a.f.length;++e){var f=null;e<a.f.length-1?f=a.f[e+1].endTime:(f=a.f[e],f=null!=f.endTime?f.endTime+(f.endTime-f.startTime):null);if(null==f||f+a.Xb.Xa>=c){d=e;break}}0!=d&&a.f.splice(0,d)}};function Zc(a,b,c,d,e,f){this.P=a;this.ca=b;this.Pb=c;this.bb=d;this.Ub=e;this.zb=f;this.c=this.B=null}Zc.prototype.destroy=function(){this.ca=this.P=null;cc(this.bb);this.bb=null;this.Ub&&(cc(this.Ub),this.Ub=null);this.c&&(this.c.destroy(),this.c=null);this.B=null};
Zc.prototype.create=function(){if(this.B)return this.B;var a=[this.bb.xb()];"webm"==this.Pb&&a.push(this.Ub.xb());return this.B=Promise.all(a).then(D(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.Pb?(d=new Pb,d=d.parse(new DataView(c),this.bb.Wa,this.bb.url)):"webm"==this.Pb&&(d=new Kb,d=d.parse(new DataView(c),new DataView(a),this.bb.url));if(!d)return c=Error("Failed to parse segment references from",this.Pb,"container."),c.type="stream",Promise.reject(c);c="dynamic"==this.P.type?
new Q(d,this.P,this.ca,this.zb):new N(d);return Promise.resolve(c)}))};function $c(a,b,c,d){this.P=a;this.ca=b;this.D=c;this.zb=d;this.c=null}$c.prototype.destroy=function(){this.D=this.ca=this.P=null;this.c&&(this.c.destroy(),this.c=null)};
$c.prototype.create=function(){if(this.c)return Promise.resolve(this.c);for(var a=this.D.o,b=a.sa.lc,c=0,d=[],e=0;e<b.length&&b[e].duration;++e)for(var f=null!=b[e].startTime?b[e].startTime:c,g=b[e].repeat||0,k=0;k<=g;++k){var l=f+b[e].duration;0<d.length&&f!=c&&(d[d.length-1].end=f);d.push({start:f,end:l});c=f=l}b=[];for(c=0;c<d.length;++c){g=d[c].start;e=g/a.p;f=d[c].end/a.p;g=ad(this.D,c+a.X,g);if(!g)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);b.push(new M(e,
f,0,null,new L(g)))}this.c="dynamic"==this.P.type?new Q(b,this.P,this.ca,this.zb):new N(b);return Promise.resolve(this.c)};function bd(a,b,c,d){var e=1,f=0,g;if(a.va>d)g=null;else{var k=a.jc||0,l=a.Xa||0;g=c.o;g=g.q/g.p;var p=d-(a.va+b.start);0>p?g=null:(l=p-2*g-l,0>l&&(l=0),l=Math.ceil(l/g)*g,p-=g,0>p?g=null:(k=Math.floor(p/g)*g-k,0>k&&(k=0),k=Math.floor(k/g)*g,g={Xc:l/g+1,current:(k>=l?k:l)/g+1}))}g&&(e=g.Xc,f=g.current-g.Xc+1);e=cd(c,e,f);if(null==e)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;Q.call(this,e,a,b,d);this.D=c;this.Ca=0<this.length()?a.va+b.start+O(this).endTime:null;this.lb=
g?g.current+1:null}q(bd,Q);bd.prototype.destroy=function(){this.D=null;Q.prototype.destroy.call(this)};bd.prototype.gd=function(a){if(null!=this.Ca||!(a instanceof bd)||null==a.Ca)return!1;Lb(this,a);this.Ca=a.Ca;this.lb=a.lb;return!0};
bd.prototype.Ic=function(a){if(null!=this.Ca&&null!=this.lb){var b=this.D.o,b=b.q/b.p,c=Math.floor((a-(this.Xb.jc||0)-this.Ca)/b);if(0!=c){var d=cd(this.D,this.lb,c);Array.prototype.push.apply(this.f,Mb(d,this.ja));this.Ca+=c*b;this.lb+=c}}Q.prototype.Ic.call(this,a)};function ed(a,b,c,d){this.P=a;this.ca=b;this.D=c;this.zb=d;this.c=null}ed.prototype.destroy=function(){this.D=this.ca=this.P=null;this.c&&(this.c.destroy(),this.c=null)};
ed.prototype.create=function(){if(this.c)return Promise.resolve(this.c);if("dynamic"==this.P.type)try{this.c=new bd(this.P,this.ca,this.D,this.zb)}catch(a){return Promise.reject(a)}else{var b=this.D.o,b=cd(this.D,1,Math.ceil(this.ca.duration/(b.q/b.p)));if(!b)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b);this.c=new N(b)}return Promise.resolve(this.c)};function fd(){this.id=this.url=null;this.type="static";this.oa=this.d=null;this.ba=5;this.Xa=this.va=this.Cc=null;this.jc=1;this.v=[]}function gd(){this.o=this.A=this.F=this.d=this.duration=this.start=this.id=null;this.ua=[]}function hd(){this.o=this.A=this.F=this.d=this.Y=this.n=this.height=this.width=this.contentType=this.lang=this.id=null;this.la=[];this.V=[]}function id(){this.value=null}function jd(){this.contentType=this.lang=this.id=null}
function kd(){this.o=this.A=this.F=this.d=this.Y=this.n=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.la=[];this.yb=!1}function ld(){this.value=this.schemeIdUri=null;this.children=[];this.pssh=null}function md(){this.parsedPssh=this.psshBox=null}function nd(){this.url=null}function od(){this.d=null;this.p=1;this.J=this.Ta=this.za=this.w=null}
od.prototype.clone=function(){var a=new od;a.d=this.d?new L(this.d):null;a.p=this.p;a.w=this.w;a.za=R(this.za);a.Ta=R(this.Ta);a.J=R(this.J);return a};function pd(){this.U=this.url=null}pd.prototype.clone=function(){var a=new pd;a.url=this.url?new L(this.url):null;a.U=R(this.U);return a};function qd(){this.U=this.url=null}qd.prototype.clone=function(){var a=new qd;a.url=this.url?new L(this.url):null;a.U=R(this.U);return a};
function rd(){this.d=null;this.p=1;this.q=this.w=null;this.X=1;this.J=null;this.Va=[]}rd.prototype.clone=function(){var a=new rd;a.d=this.d?new L(this.d):null;a.p=this.p;a.w=this.w;a.q=this.q;a.X=this.X;a.J=R(this.J);a.Va=this.Va.map(function(a){return a.clone()});return a};function sd(){this.ib=this.Cb=null}sd.prototype.clone=function(){var a=new sd;a.Cb=this.Cb?new L(this.Cb):null;a.ib=R(this.ib);return a};function td(){this.p=1;this.q=this.w=null;this.X=1;this.sa=this.cb=this.Aa=this.jb=null}
td.prototype.clone=function(){var a=new td;a.p=this.p;a.w=this.w;a.q=this.q;a.X=this.X;a.jb=this.jb;a.Aa=this.Aa;a.cb=this.cb;a.sa=R(this.sa);return a};function ud(){this.lc=[]}ud.prototype.clone=function(){var a=new ud;a.lc=this.lc.map(function(a){return a.clone()});return a};function vd(){this.repeat=this.duration=this.startTime=null}vd.prototype.clone=function(){var a=new vd;a.startTime=this.startTime;a.duration=this.duration;a.repeat=this.repeat;return a};
function wd(a,b){this.sb=a;this.end=b}wd.prototype.clone=function(){return new wd(this.sb,this.end)};fd.TAG_NAME="MPD";gd.TAG_NAME="Period";hd.TAG_NAME="AdaptationSet";id.TAG_NAME="Role";jd.TAG_NAME="ContentComponent";kd.TAG_NAME="Representation";ld.TAG_NAME="ContentProtection";md.TAG_NAME="cenc:pssh";nd.TAG_NAME="BaseURL";od.TAG_NAME="SegmentBase";pd.TAG_NAME="RepresentationIndex";qd.TAG_NAME="Initialization";rd.TAG_NAME="SegmentList";sd.TAG_NAME="SegmentURL";td.TAG_NAME="SegmentTemplate";
ud.TAG_NAME="SegmentTimeline";vd.TAG_NAME="S";fd.prototype.parse=function(a,b){this.url=new L(a.d);this.id=S(b,"id",T);this.type=S(b,"type",T)||"static";this.oa=S(b,"mediaPresentationDuration",xd);this.ba=S(b,"minBufferTime",xd,this.ba);this.Cc=S(b,"minimumUpdatePeriod",xd,this.Cc);this.va=S(b,"availabilityStartTime",yd,this.va);this.Xa=S(b,"timeShiftBufferDepth",xd,this.Xa);this.jc=S(b,"suggestedPresentationDelay",xd,this.jc);var c=U(this,b,nd);this.d=zd(a.d,c?c.url:null);this.v=Ad(this,b,gd)};
gd.prototype.parse=function(a,b){this.id=S(b,"id",T);this.start=S(b,"start",xd);this.duration=S(b,"duration",xd);var c=U(this,b,nd);this.d=zd(a.d,c?c.url:null);this.F=U(this,b,od);this.A=U(this,b,rd);this.o=U(this,b,td);this.ua=Ad(this,b,hd)};
hd.prototype.parse=function(a,b){var c=U(this,b,jd)||{},d=U(this,b,id);this.id=S(b,"id",T);this.lang=S(b,"lang",T,c.lang);this.contentType=S(b,"contentType",T,c.contentType);this.width=S(b,"width",V);this.height=S(b,"height",V);this.n=S(b,"mimeType",T);this.Y=S(b,"codecs",T);this.yb=d&&"main"==d.value;this.lang&&(this.lang=ya(this.lang));c=U(this,b,nd);this.d=zd(a.d,c?c.url:null);this.la=Ad(this,b,ld);!this.contentType&&this.n&&(this.contentType=this.n.split("/")[0]);this.F=a.F?Bd(this,b,a.F):U(this,
b,od);this.A=a.A?Bd(this,b,a.A):U(this,b,rd);this.o=a.o?Bd(this,b,a.o):U(this,b,td);this.V=Ad(this,b,kd);!this.n&&this.V.length&&(this.n=this.V[0].n,!this.contentType&&this.n&&(this.contentType=this.n.split("/")[0]))};id.prototype.parse=function(a,b){this.value=S(b,"value",T)};jd.prototype.parse=function(a,b){this.id=S(b,"id",T);this.lang=S(b,"lang",T);this.contentType=S(b,"contentType",T);this.lang&&(this.lang=ya(this.lang))};
kd.prototype.parse=function(a,b){this.id=S(b,"id",T);this.bandwidth=S(b,"bandwidth",V);this.width=S(b,"width",V,a.width);this.height=S(b,"height",V,a.height);this.n=S(b,"mimeType",T,a.n);this.Y=S(b,"codecs",T,a.Y);this.lang=a.lang;var c=U(this,b,nd);this.d=zd(a.d,c?c.url:null);this.la=Ad(this,b,ld);this.F=a.F?Bd(this,b,a.F):U(this,b,od);this.A=a.A?Bd(this,b,a.A):U(this,b,rd);this.o=a.o?Bd(this,b,a.o):U(this,b,td);0==this.la.length&&(this.la=a.la)};
ld.prototype.parse=function(a,b){this.schemeIdUri=S(b,"schemeIdUri",T);this.value=S(b,"value",T);this.pssh=U(this,b,md);this.children=Array.prototype.slice.call(b.childNodes)};md.prototype.parse=function(a,b){var c=Cd(b);if(c){this.psshBox=pa(c);try{this.parsedPssh=new Ja(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};nd.prototype.parse=function(a,b){this.url=Cd(b)};
od.prototype.parse=function(a,b){this.d=a.d||this.d;this.p=S(b,"timescale",V,this.p);this.w=S(b,"presentationTimeOffset",W,this.w);this.za=S(b,"indexRange",Dd,this.za);this.Ta=U(this,b,pd)||this.Ta;this.J=U(this,b,qd)||this.J};pd.prototype.parse=function(a,b){var c=S(b,"sourceURL",T);this.url=zd(a.d,c);this.U=S(b,"range",Dd,R(a.za))};qd.prototype.parse=function(a,b){var c=S(b,"sourceURL",T);this.url=zd(a.d,c);this.U=S(b,"range",Dd)};
rd.prototype.parse=function(a,b){this.d=a.d||this.d;this.p=S(b,"timescale",V,this.p);this.w=S(b,"presentationTimeOffset",W,this.w);this.q=S(b,"duration",V,this.q);this.X=S(b,"startNumber",V,this.X)||1;this.J=U(this,b,qd)||this.J;this.Va=Ad(this,b,sd)||this.Va};sd.prototype.parse=function(a,b){var c=S(b,"media",T);this.Cb=zd(a.d,c);this.ib=S(b,"mediaRange",Dd)};
td.prototype.parse=function(a,b){this.p=S(b,"timescale",V,this.p);this.w=S(b,"presentationTimeOffset",W,this.w);this.q=S(b,"duration",V,this.q);this.X=S(b,"startNumber",V,this.X)||1;this.jb=S(b,"media",T,this.jb);this.Aa=S(b,"index",T,this.Aa);this.cb=S(b,"initialization",T,this.cb);this.sa=U(this,b,ud)||this.sa};ud.prototype.parse=function(a,b){this.lc=Ad(this,b,vd)};vd.prototype.parse=function(a,b){this.startTime=S(b,"t",W);this.duration=S(b,"d",W);this.repeat=S(b,"r",W)};
function zd(a,b){var c=b?new L(b):null;return a?c?a.resolve(c):a:c}function Bd(a,b,c){var d=R(c);(b=Ed(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function U(a,b,c){var d=null;if(b=Ed(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}function Ed(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}
function Ad(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Cd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function R(a){return a?a.clone():null}function S(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function yd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function xd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=W(b[1]);c&&(a+=31536E3*c);(c=W(b[2]))&&(a+=2592E3*c);(c=W(b[3]))&&(a+=86400*c);(c=W(b[4]))&&(a+=3600*c);(c=W(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Dd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=W(b[1]);if(null==a)return null;b=W(b[2]);return null==b?null:new wd(a,b)}function V(a){a=window.parseInt(a,10);return 0<a?a:null}function W(a){a=window.parseInt(a,10);return 0<=a?a:null}function T(a){return a};function Fd(a){Qb.call(this,a);this.h.responseType="text";this.h.Ab=3;this.h.Zb=Gd;this.h.Cd=!0}q(Fd,Qb);var Gd=0;Fd.prototype.send=function(){var a=this.url;return this.fc().then(function(b){b=b.responseText;if(b=(new DOMParser).parseFromString(b,"text/xml")){var c={d:new L(a)};b=U(c,b,fd)}else b=null;if(b)return Promise.resolve(b);b=Error("MPD parse failure.");b.type="mpd";return Promise.reject(b)})};function cd(a,b,c){for(var d=a.o,e=[],f=0;f<c;++f){var g=f+b,k=(g-1)*d.q,l=k/d.p,k=(k+d.q)/d.p,g=ad(a,g-1+d.X,(g-1+(d.X-1))*d.q);if(!g)return null;e.push(new M(l,k,0,null,new L(g)))}return e}function ad(a,b,c){if(!a.o)return null;var d=a.o.jb;return d?(b=Hd(d,a.id,b,a.bandwidth,c))?a.d?a.d.resolve(b):b:null:a.d?new L(a.d):null}
function Hd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new L(a)}catch(g){if(g instanceof URIError)return null;throw g;}};function Id(a){this.fb=a}
Id.prototype.Qa=function(a){for(var b=(Date.now()+ca)/1E3,c=0;c<a.v.length;++c)for(var d=a.v[c],e=0;e<d.ua.length;++e){var f=d.ua[e];if("text"!=f.contentType)for(var g=0;g<f.V.length;++g){var k=f.V[g],l=0,l=l+(k.F?1:0),l=l+(k.A?1:0),l=l+(k.o?1:0);0==l?(f.V.splice(g,1),--g):1!=l&&(k.F?(k.A=null,k.o=null):k.A&&(k.o=null))}}Jd(a);for(c=0;c<a.v.length;++c)for(d=a.v[c],e=0;e<d.ua.length;++e){g=f=d.ua[e];k=null;for(l=0;l<g.V.length;++l){var p=g.V[l].n||"";k?p!=k&&(g.V.splice(l,1),--l):k=p}0==f.V.length&&
(d.ua.splice(e,1),--e)}"dynamic"==a.type&&null==a.va&&(a.va=b);c=new qc;"dynamic"==a.type&&(c.Da=!0,c.Kb=a.Cc,c.Lb=new L(a.url));c.ba=a.ba||5;for(d=0;d<a.v.length;++d){e=a.v[d];if(null==e.start)break;f=new pc;f.id=e.id;f.start=e.start||0;f.duration=e.duration;for(g=0;g<e.ua.length;++g){k=e.ua[g];l=new mc;l.id=k.id;l.yb=k.yb;l.contentType=k.contentType||"";l.lang=k.lang||"";for(p=0;p<k.V.length;++p){var n=k.V[p],y=l.Ja.slice(0),w=y,x;x=n;var v=[];if(0==x.la.length)v.push(pb());else if(this.fb)for(var t=
0;t<x.la.length;++t){var s=this.fb(x.la[t]);s&&v.push(s)}x=v;if(0==w.length)Array.prototype.push.apply(w,x);else for(v=0;v<w.length;++v){t=!1;for(s=0;s<x.length;++s)if(w[v].key()==x[s].key()){t=!0;break}t||(w.splice(v,1),--v)}if(!(0==y.length&&0<l.Ja.length)){x=a;w=e;v=b;if(n.d){var t=null,s=1,u=0;if(n.F)t=n.n.split("/")[1],"mp4"!=t&&"webm"!=t?t=null:(s=n.F,"webm"!=t||s.J?s.za||s.Ta&&s.Ta.U?(u=s.Ta,u||(u=new pd,u.url=new L(n.d),u.U=s.za?s.za.clone():null),u=Kd(u),s=s.J?Kd(s.J):null,w=new Zc(x,w,t,
u,s,v),x=new ic(s),v=new jc,v.G=w,v.H=x,t=v):t=null:t=null),s=n.F.p,u=n.F.w;else if(n.A)v=n.A,!v.q&&1<v.Va.length?t=null:(v=v.J?Kd(v.J):null,w=new Xc(x,w,n),x=new ic(v),v=new jc,v.G=w,v.H=x,t=v),s=n.A.p,u=n.A.w;else if(n.o){b:if(t=n.o,s=t,u=0,u+=s.Aa?1:0,u+=s.sa?1:0,u+=s.q?1:0,0==u?s=!1:(1!=u&&(s.Aa?(s.sa=null,s.q=null):s.sa&&(s.q=null)),s=!0),s){s=null;if(t.cb&&(s=(t=n.o.cb)?Ld(n,t,qd):null,!s)){t=null;break b}t=s?Kd(s):null;var u=n,s=t,H=u.o;if(H.Aa){H=void 0;H=u.n.split("/")[1];if("mp4"!=H&&"webm"!=
H)H=null;else if("webm"==H&&!s||!ad(u,1,0))H=null;else{var dd=u.o.Aa;(u=dd?Ld(u,dd,pd):null)?(u=Kd(u),H=new Zc(x,w,H,u,s,v)):H=null}w=H}else w=H.jb?H.sa?new $c(x,w,u,v):H.q?"dynamic"!=x.type&&null==w.duration?null:new ed(x,w,u,v):void 0:null;w?(x=new ic(t),v=new jc,v.G=w,v.H=x,t=v):t=null}else t=null;s=n.o.p;u=n.o.w}else"text"==n.n.split("/")[0]&&(t=new jc,t.G=new Ob(new L(n.d)));t?(t.id=n.id,u&&(t.timestampOffset=-1*u/s),t.bandwidth=n.bandwidth,t.width=n.width,t.height=n.height,t.n=n.n||"",t.Y=n.Y||
"",n=t):n=null}else n=null;n&&(l.e.push(n),l.Ja=y)}}f.u.push(l)}c.t.push(f)}return c};
function Jd(a){if(a.v.length){null==a.v[0].start&&(a.v[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.oa=null);b(a.oa)&&1==a.v.length&&!b(a.v[0].duration)&&(a.v[0].duration=a.oa);for(var c=0,d=!0,e=0;e<a.v.length;++e){var f=a.v[e-1],g=a.v[e],k=a.v[e+1]||{start:a.oa};!b(g.start)&&f&&b(f.start)&&b(f.duration)&&(g.start=f.start+f.duration);!b(g.duration)&&b(k.start)&&(g.duration=k.start-g.start);null!=g.start&&null!=g.duration?c+=g.duration:d=!1}b(a.oa)||(e=a.v[a.v.length-1],d?
a.oa=c:b(e.start)&&b(e.duration)?a.oa=e.start+e.duration:"dynamic"!=a.type&&(a.oa=c))}}function Ld(a,b,c){b=Hd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=a.d&&b?a.d.resolve(b):b;return c}function Kd(a){var b=new L(a.url),c=0,d=null;a.U&&(c=a.U.sb,d=a.U.end);return new bc(b,c,d)};function Md(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Nd(a){a.playTime+=Oa("playing")/1E3}function Od(a,b){var c=new Pd(b);a.streamHistory.push(new Qd(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}
function Pd(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.n;this.videoBandwidth=a.bandwidth}function Qd(a){this.timestamp=(Date.now()+ca)/1E3;this.value=a};function X(a){K.call(this,null);this.a=a;this.b=null;this.l=new E;this.Ka=null;this.na="en";this.oc=this.ac=null;this.ab=!1;this.K=new Md;this.qc=!0;this.$b=new ob}q(X,K);m("shaka.player.Player",X);X.version="v1.3.0-68-gb306a9d-dirty";
X.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!HTMLVideoElement.prototype.getVideoPlaybackQuality&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!document.body.children};
function Bc(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}X.isTypeSupported=Bc;X.prototype.destroy=function(){return this.Rc().then(D(this,function(){this.l.destroy();this.a=this.l=null})).catch(function(){})};X.prototype.destroy=X.prototype.destroy;
X.prototype.Rc=function(){if(!this.b)return Promise.resolve();this.ab&&Rd(this);this.a.pause();sa(this.l);Sd(this);Td(this);this.Ka.destroy();this.Ka=null;this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.ab=!1;this.K=new Md;return a};X.prototype.unload=X.prototype.Rc;
X.prototype.load=function(a){var b=this.Rc();this.a.autoplay&&(Ka("load"),F(this.l,this.a,"timeupdate",this.ee.bind(this)));a.tb(this.qc);return b.then(D(this,function(){return a.load(this.na)})).then(D(this,function(){this.b=a;this.b.qb(this.$b);this.Ka=new zc(this,this.a,this.b);return Ac(this.Ka)})).then(D(this,function(){F(this.l,this.a,"error",this.Gc.bind(this));F(this.l,this.a,"playing",this.ke.bind(this));F(this.l,this.a,"pause",this.ie.bind(this));return this.b.Vc(this,this.a)})).then(D(this,
function(){Ud(this)})).catch(D(this,function(b){a.destroy();this.b=null;this.Ka&&(this.Ka.destroy(),this.Ka=null);var d=I(b);this.dispatchEvent(d);return Promise.reject(b)}))};X.prototype.load=X.prototype.load;h=X.prototype;h.ee=function(){Na("load");this.K.playbackLatency=Oa("load")/1E3;this.l.Jb(this.a,"timeupdate")};h.Gc=function(a){this.a.error&&(a=this.a.error.code,a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Vd[a]||"Unknown playback error."),a.type="playback",a=I(a),this.dispatchEvent(a)))};
h.ke=function(){Ka("playing");this.ab&&Rd(this)};h.ie=function(){Na("playing");Nd(this.K)};h.getStats=function(){this.a.paused||(Na("playing"),Nd(this.K),Ka("playing"));var a=this.K,b=this.a.getVideoPlaybackQuality();b&&(a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.K};X.prototype.getStats=X.prototype.getStats;X.prototype.Nd=function(){var a=this.a.videoWidth,b=this.a.videoHeight;return a&&b?{width:a,height:b}:null};X.prototype.getCurrentResolution=X.prototype.Nd;
X.prototype.getVideoTracks=function(){return this.b?this.b.getVideoTracks():[]};X.prototype.getVideoTracks=X.prototype.getVideoTracks;X.prototype.getAudioTracks=function(){return this.b?this.b.getAudioTracks():[]};X.prototype.getAudioTracks=X.prototype.getAudioTracks;X.prototype.Tb=function(){return this.b?this.b.Tb():[]};X.prototype.getTextTracks=X.prototype.Tb;X.prototype.Hb=function(a,b){return this.b?this.b.Hb(a,void 0==b?!0:b):!1};X.prototype.selectVideoTrack=X.prototype.Hb;
X.prototype.dc=function(a){return this.b?this.b.dc(a,!1):!1};X.prototype.selectAudioTrack=X.prototype.dc;X.prototype.ec=function(a){return this.b?this.b.ec(a,!1):!1};X.prototype.selectTextTrack=X.prototype.ec;X.prototype.ub=function(a){this.b&&this.b.ub(a)};X.prototype.enableTextTrack=X.prototype.ub;X.prototype.tb=function(a){this.qc=a;this.b&&this.b.tb(a)};X.prototype.enableAdaptation=X.prototype.tb;X.prototype.Md=function(){return this.qc};X.prototype.getAdaptationEnabled=X.prototype.Md;
X.prototype.Od=function(){return this.a.currentTime};X.prototype.getCurrentTime=X.prototype.Od;X.prototype.Pd=function(){return this.a.duration};X.prototype.getDuration=X.prototype.Pd;X.prototype.Qd=function(){return this.a.muted};X.prototype.getMuted=X.prototype.Qd;X.prototype.Td=function(){return this.a.volume};X.prototype.getVolume=X.prototype.Td;X.prototype.play=function(){this.zd(1);this.a.play()};X.prototype.play=X.prototype.play;X.prototype.pause=function(){this.a.pause()};
X.prototype.pause=X.prototype.pause;X.prototype.requestFullscreen=function(){this.a.requestFullscreen()};X.prototype.requestFullscreen=X.prototype.requestFullscreen;X.prototype.seek=function(a){this.a.currentTime=a};X.prototype.seek=X.prototype.seek;X.prototype.Le=function(a){tc=0>a?0:a};X.prototype.setStreamBufferSize=X.prototype.Le;X.prototype.Sd=function(){return tc};X.prototype.getStreamBufferSize=X.prototype.Sd;X.prototype.Ge=function(a){yc=a};X.prototype.setLicenseRequestTimeout=X.prototype.Ge;
X.prototype.He=function(a){Gd=a};X.prototype.setMpdRequestTimeout=X.prototype.He;X.prototype.Ke=function(a){ac=a};X.prototype.setRangeRequestTimeout=X.prototype.Ke;X.prototype.Ie=function(a){this.a.muted=a};X.prototype.setMuted=X.prototype.Ie;X.prototype.Me=function(a){this.a.volume=a};X.prototype.setVolume=X.prototype.Me;X.prototype.Je=function(a){this.na=ya(a)};X.prototype.setPreferredLanguage=X.prototype.Je;
X.prototype.zd=function(a){Td(this);0<=a?this.a.playbackRate=a:(this.a.playbackRate=0,this.rd(this.a.currentTime,Date.now(),a))};X.prototype.setPlaybackRate=X.prototype.zd;X.prototype.qb=function(a){if(!(a instanceof ob))throw new TypeError("Argument must be a Restrictions instance.");this.$b=a.clone();this.b&&this.b.qb(this.$b)};X.prototype.setRestrictions=X.prototype.qb;X.prototype.Rd=function(){return this.$b.clone()};X.prototype.getRestrictions=X.prototype.Rd;
X.prototype.Vb=function(){return this.b?this.b.Vb():!1};X.prototype.isLive=X.prototype.Vb;function Td(a){a.ac&&(window.clearTimeout(a.ac),a.ac=null)}function Ud(a){Sd(a);a.oc=window.setTimeout(a.ve.bind(a),100)}function Sd(a){a.oc&&(window.clearTimeout(a.oc),a.oc=null)}X.prototype.rd=function(a,b,c){this.a.currentTime=a+(Date.now()-b)/1E3*c;this.ac=window.setTimeout(this.rd.bind(this,a,b,c),100)};
function Rd(a){Na("buffering");var b=a.K;b.bufferingTime+=Oa("buffering")/1E3;a.ab=!1;a.dispatchEvent(G({type:"bufferingEnd"}))}X.prototype.ve=function(){Ud(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=b-this.a.currentTime,b=b+.05;this.ab?a>this.b.$c()&&(Rd(this),this.a.play()):b<this.a.duration&&.1>a&&!this.a.paused&&(this.ab=!0,this.a.pause(),this.K.bufferingHistory.push((Date.now()+ca)/1E3),Ka("buffering"),this.dispatchEvent(G({type:"bufferingStart"})))}};
var Vd={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Wd(){}Wd.prototype.Qa=function(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.u.length;++d){for(var e=c.u[d],f=e,g=0;g<f.e.length;++g)Bc(lc(f.e[g]))||(f.e.splice(g,1),--g);0==e.e.length&&(c.u.splice(d,1),--d)}for(b=0;b<a.length;++b)for(c=a[b],d=0;d<c.u.length;++d)c.u[d].e.sort(Xd)};function Xd(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Yd(a){this.pa=a}Yd.prototype.destroy=function(){this.pa.destroy();this.pa=null};Yd.prototype.update=function(a){var b=Zd(a),c=Zd(this.pa);return Promise.all([b,c]).then(function(b){var c=b[0];b=b[1];var f=new Wd;f.Qa(this.pa.t);a.Kb=this.pa.Kb;a.Lb=this.pa.Lb?new L(this.pa.Lb):null;a.ba=this.pa.ba;var g=[];$d(a,this.pa,c,b,g);f.Qa(a.t);return Promise.resolve(g)}.bind(this))};
function Zd(a){function b(a,b){return a.concat(b)}var c=a.t.map(function(a){return a.u}).reduce(b,[]).map(function(a){return a.e}).reduce(b,[]);a=c.map(function(a){return a.G.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].I]=a[f];return Promise.resolve(b)})}
function $d(a,b,c,d,e){var f=new r;a.t.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.t.forEach(function(a,b){g.push(a.id||""+b,a)});a=f.keys();for(b=0;b<a.length;++b){var k=a[b],l=f.get(k);1<l.length||(k=g.get(k))&&0!=k.length&&1==k.length&&(ae(l[0],k[0],c,d,e),l[0].duration=k[0].duration)}}
function ae(a,b,c,d,e){var f=new r;a.u.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.u.forEach(function(a,b){g.push(a.id||""+b,a)});a=f.keys();for(b=0;b<a.length;++b){var k=a[b],l=f.get(k);1<l.length||(k=g.get(k))&&0!=k.length&&1==k.length&&be(l[0],k[0],c,d,e)}}
function be(a,b,c,d,e){var f=new r;a.e.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new r;b.e.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var k=f.keys(),l=0;l<k.length;++l){var p=k[l];b[p]=p;var n=f.get(p);1<n.length||((p=g.get(p))&&0!=p.length?1==p.length&&(ce(n[0],p[0],c,d),n[0].H=p[0].H,p[0].H=null,n[0].timestampOffset=p[0].timestampOffset):(e.push(n[0]),a.e.splice(a.e.indexOf(n[0]),1)))}k=g.keys();for(l=0;l<k.length;++l)p=k[l],b[p]||(b[p]=p,p=g.get(p),a.e.push(p[0]))}
function ce(a,b,c,d){a=c[a.I];b=d[b.I];a.length();a.gd(b)&&a.length()};function Y(){this.b=this.O=null;this.l=new E;this.kb=Number.POSITIVE_INFINITY;this.vb=!0}m("shaka.media.SimpleAbrManager",Y);Y.prototype.destroy=function(){this.l.destroy();this.b=this.O=this.l=null};Y.prototype.start=function(a,b){this.O&&this.b||(this.O=a,this.b=b,this.kb=Date.now()+4E3,F(this.l,this.O,"bandwidth",this.Fc.bind(this)),F(this.l,this.b,"adaptation",this.de.bind(this)))};Y.prototype.enable=function(a){this.vb=a};
Y.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.O)return null;var a=de(this);return a?a.id:null};Y.prototype.Fc=function(){if(this.vb&&!(Date.now()<this.kb)){var a=de(this);if(a){if(a.active){this.kb=Date.now()+3E3;return}this.b.Hb(a.id,!1)}this.kb=Number.POSITIVE_INFINITY}};Y.prototype.de=function(){this.kb==Number.POSITIVE_INFINITY&&(this.kb=Date.now()+3E4)};
function de(a){var b=a.b.getVideoTracks();if(0==b.length)return null;b.sort(sb);var c;a:{c=a.b.getAudioTracks();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.O.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function ee(a,b,c){K.call(this,null);this.Zd=a;this.Dd=b;this.M=c?c:pb();this.ia=null}q(ee,K);m("shaka.player.HttpVideoSource",ee);ee.prototype.destroy=function(){this.ia&&(this.ia.parentElement.removeChild(this.ia),this.ia=null);this.parent=this.M=null};h=ee.prototype;h.Vc=function(a,b){this.parent=a;var c=b.mediaKeys;b.src=this.Zd;c=b.setMediaKeys(c);this.Dd&&(this.ia=document.createElement("track"),this.ia.src=this.Dd,b.appendChild(this.ia),this.ia.track.mode="showing");return c};h.load=function(){return Promise.resolve()};
h.getVideoTracks=function(){return[]};h.getAudioTracks=function(){return[]};h.Tb=function(){return[]};h.$c=function(){return 5};h.Zc=function(){var a=new oc;a.Z=this.M;return[a]};h.Mc=function(){};h.Hb=function(){return!1};h.dc=function(){return!1};h.ec=function(){return!1};h.ub=function(a){this.ia&&(this.ia.track.mode=a?"showing":"disabled")};h.tb=function(){};h.qb=function(){};h.Sb=function(){return[]};h.Wb=function(){return!1};h.Vb=function(){return!1};function Z(a,b,c){K.call(this,null);this.g=a;this.N=b;this.ea=new E;this.T=new MediaSource;this.video=null;this.r=new r;this.rb=c;this.gb=!1;this.na="";this.ic=!1;this.K=null;this.Mb=new z;this.Nb=null;this.ud=1;this.s={};this.nd=Number.POSITIVE_INFINITY;this.hb=Number.NEGATIVE_INFINITY;this.R=null}q(Z,K);m("shaka.player.StreamVideoSource",Z);
Z.prototype.destroy=function(){this.Ob();this.ea.destroy();this.ea=null;ra(this.s).forEach(function(a){a.destroy()});this.r=this.s=null;this.g&&(this.g.destroy(),this.g=null);this.rb.destroy();this.parent=this.Nb=this.Mb=this.K=this.video=this.T=this.N=this.rb=null};h=Z.prototype;
h.Vc=function(a,b){if(!this.gb){var c=Error("Cannot call attach() right now.");c.type="stream";return Promise.reject(c)}this.parent=a;this.video=b;this.K=a.getStats();F(this.ea,this.T,"sourceopen",this.he.bind(this));F(this.ea,this.N,"bandwidth",this.Fc.bind(this));c=this.video.mediaKeys;this.video.src=window.URL.createObjectURL(this.T);c=this.video.setMediaKeys(c);return Promise.all([this.Mb,c])};
h.load=function(a){if(this.gb)return a=Error("Cannot call load() right now."),a.type="stream",Promise.reject(a);if(!this.g||0==this.g.t.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);this.na=a;(new Wd).Qa(this.g.t);if(0==this.g.t.length||0==this.g.t[0].u.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.gb=!0;return Promise.resolve()};
h.ue=function(){var a=Date.now(),b=this.R=null;this.td(this.g.Lb).then(D(this,function(a){b=new Yd(a);return b.update(this.g)})).then(D(this,function(c){b.destroy();b=null;for(var d=0;d<c.length;++d)fe(this,c[d]);this.Nb&&this.qb(this.Nb);0==Object.keys(this.s).length?ge(this):this.ha((Date.now()-a)/1E3)})).catch(D(this,function(a){b&&(b.destroy(),b=null);"aborted"!=a.type&&(a=I(a),this.dispatchEvent(a))}))};h.td=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
function fe(a,b){var c=a.s[b.n.split("/")[0]];if(c&&c.L==b){var d=a.r.get(b.n.split("/")[0]),e=d.map(function(a){return a.e}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.enabled});if(0==e.length){d.push(b);return}c.kc(e[0],!0);b.destroy()}b.destroy()}
h.getVideoTracks=function(){if(!this.r.has("video"))return[];for(var a=this.s.video,a=(a=a?a.L:null)?a.I:0,b=[],c=this.r.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.e.length;++f){var g=e.e[f];if(g.enabled){var k=g.I,g=new rb(k,g.bandwidth,g.width,g.height);k==a&&(g.active=!0);b.push(g)}}return b};
h.getAudioTracks=function(){if(!this.r.has("audio"))return[];for(var a=this.s.audio,a=(a=a?a.L:null)?a.I:0,b=[],c=this.r.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.e.length;++g){var k=e.e[g],l=k.I,k=new ub(l,k.bandwidth,f);l==a&&(k.active=!0);b.push(k)}return b};
h.Tb=function(){if(!this.r.has("text"))return[];for(var a=this.s.text,b=a?a.L:null,b=b?b.I:0,c=[],d=this.r.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,k=0;k<f.e.length;++k){var l=f.e[k].I,p=new tb(l,g);l==b&&(p.active=!0,p.enabled=a.xc());c.push(p)}return c};h.$c=function(){return this.g&&this.g.ba||0};h.Zc=function(){return this.gb?this.g.t[0].wc():[]};
h.Mc=function(a){if(this.gb){for(var b={},c=this.g.t[0],d=0;d<c.u.length;++d){var e=c.u[d];b[e.I]=e}this.r.clear();c=a.keys();for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.r.push(e,b[g])}else if("audio"==e)for(var g=f[0].ya.split(";")[0],k=0;k<f.length;++k){var l=f[k];l.ya.split(";")[0]==g&&this.r.push(e,b[l.id])}else for(k=0;k<f.length;++k)g=f[k].id,this.r.push(e,b[g])}this.ic=!0;if(a=this.r.get("audio"))he(this,a),this.r.set("audio",a),a=a[0].lang||this.na,xa(2,
this.na,a)&&(this.ic=!1);if(a=this.r.get("text"))he(this,a),this.r.set("text",a),a=a[0].lang||this.na,xa(2,this.na,a)||(this.ic=!1)}};h.Hb=function(a,b){return ie(this,"video",a,b)};h.dc=function(a,b){return ie(this,"audio",a,b)};h.ec=function(a,b){return ie(this,"text",a,b)};h.ub=function(a){var b=this.s.text;b&&b.hc(a)};h.tb=function(a){this.rb.enable(a)};
h.qb=function(a){if(this.gb){this.Nb=a;for(var b=0;b<this.g.t.length;++b)for(var c=this.g.t[b],d=0;d<c.u.length;++d)for(var e=c.u[d],f=0;f<e.e.length;++f){var g=e.e[f];g.enabled=!0;a.maxWidth&&g.width>a.maxWidth&&(g.enabled=!1);a.maxHeight&&g.height>a.maxHeight&&(g.enabled=!1);a.maxBandwidth&&g.bandwidth>a.maxBandwidth&&(g.enabled=!1);a.minBandwidth&&g.bandwidth<a.minBandwidth&&(g.enabled=!1)}}};h.Sb=function(){return[]};h.Wb=function(){return!1};h.Vb=function(){return this.g?this.g.Da:!1};
function ie(a,b,c,d){if(!a.r.has(b)||!a.s[b])return!1;for(var e=a.r.get(b),f=0;f<e.length;++f)for(var g=e[f],k=0;k<g.e.length;++k){var l=g.e[k];if(l.I==c)return Od(a.K,l),a.s[b].kc(l,d),!0}return!1}function he(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(xa(c,a.na,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.yb){b.splice(d,1);b.splice(0,0,e);break}}
h.he=function(){this.ea.Jb(this.T,"sourceopen");ge(this).then(D(this,function(){this.Mb.resolve()})).catch(D(this,function(a){this.Mb.reject(a)}))};
function ge(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.r.has(e)&&b.push(a.r.get(e)[0])}a.rb.start(a.N,a);var f=je(a,b),b=ra(f).map(function(a){return a.G.create()});return Promise.all(b).then(D(a,function(a){if(!a.every(function(a){return a.length()}))return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);var b=ke(this,a);if(!b)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!le(this,f))return a=Error("Failed to create Stream objects."),
a.type="stream",Promise.reject(a);this.sd(a);me(this,f,b);return Promise.resolve()})).catch(D(a,function(a){if("aborted"!=a.type)return Object.keys(this.s),this.g.Da?(this.ha(0),Promise.resolve()):Promise.reject(a)}))}function je(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=e.e[0];if("video"==e.contentType)for(var g=a.rb.getInitialVideoTrackId(),k=0;k<e.e.length&&(f=e.e[k],f.I!=g);++k);else"audio"==e.contentType&&(f=e.e[Math.floor(e.e.length/2)]);c[e.contentType]=f}return c}
function le(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new rc(a,a.video):ne(a,e);if(!e)return ra(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.s=c;return!0}
function ke(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e];0==f.length()?d=c=0:(c=Math.max(c,f.first().startTime),a.g.Da?(f=O(f).startTime-a.g.ba,d=Math.min(d,Math.max(0,f))):null!=O(f).endTime&&(d=Math.min(d,O(f).endTime)))}return d!=Number.POSITIVE_INFINITY||(d=a.g.t[0].duration,d)?c>d?null:{start:c,end:d}:null}
function ne(a,b){var c;try{c=a.T.addSourceBuffer(lc(b))}catch(d){return null}try{c.timestampOffset=b.timestampOffset}catch(e){return null}return new sc(a,a.video,a.T,c,a.N)}function me(a,b,c){a.ud=a.video.playbackRate;a.video.playbackRate=0;a.g.Da?(a.T.duration=c.end+2592E3,c=c.end):(a.T.duration=c.end-c.start,c=c.start);a.video.currentTime=c;for(var d in a.s){c=a.s[d];F(a.ea,c,"started",a.se.bind(a));F(a.ea,c,"ended",a.re.bind(a));var e=b[d];Od(a.K,e);c.kc(e,!1)}a.ub(a.ic)}h.sd=function(){};
h.se=function(a){this.nd=Math.min(this.nd,a.ja);this.hb=Math.max(this.hb,a.ja);for(var b in this.s)if(!this.s[b].cd())return;oe(this)};
function oe(a){var b=ra(a.s).map(function(a){return a.L.G.create()});Promise.all(b).then(D(a,function(a){for(var b=0;b<a.length;++b)Nb(a[b],this.hb);var e=function(){var b=this.video.buffered,b=(b.length?b.end(b.length-1):0)-(this.video.currentTime+this.hb);b>=Math.min(this.g.ba,tc)?(this.Ec(a),this.ha(0)):window.setTimeout(e,50)}.bind(this);e()})).catch(D(a,function(a){"aborted"!=a.type&&(a=I(a),this.dispatchEvent(a))}));Promise.all(b).then(D(a,function(){var a=ba(this.r).map(function(a){return a.e}).reduce(function(a,
b){return a.concat(b)},[]).map(function(a){var b=[a.G.create()];a.H&&b.push(a.H.create());return Promise.all(b)});return Promise.all(a)})).then(D(a,function(a){for(var b=0;b<a.length;++b)Nb(a[b][0],this.hb)})).catch(D(a,function(a){"aborted"!=a.type&&(a=I(a),this.dispatchEvent(a))}))}
h.Ec=function(){this.video.currentTime+=this.hb;this.video.playbackRate=this.ud;var a=function(){this.video.removeEventListener("seeking",a);F(this.ea,this.video,"seeking",this.ne.bind(this))}.bind(this);this.video.addEventListener("seeking",a)};h.re=function(){if(!this.g.Da){for(var a in this.s)if(!this.s[a].bd())return;"open"==this.T.readyState&&this.T.endOfStream()}};h.ne=function(){this.Hc()};h.Hc=function(){for(var a in this.s)this.s[a].xd()};
h.Fc=function(){var a=this.K,b=this.N.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new Qd(b))};h.ha=function(a){null!=this.g.Kb&&(a=Math.max(this.g.Kb-a,3),this.R=window.setTimeout(this.ue.bind(this),1E3*a))};h.Ob=function(){this.R&&(window.clearTimeout(this.R),this.R=null)};function pe(a,b,c,d){c||(c=new Ia);d||(d=new Y);Z.call(this,null,c,d);this.ce=a;this.fb=b;this.da=this.W=this.yc=this.zc=this.Qc=0;this.Nc=!1;this.bc=null}q(pe,Z);m("shaka.player.DashVideoSource",pe);pe.prototype.destroy=function(){qe(this);this.fb=null;Z.prototype.destroy.call(this)};h=pe.prototype;h.load=function(a){return(new Fd(this.ce)).send().then(D(this,function(b){this.g=(new Id(this.fb)).Qa(b);this.Qc=b.Xa||0;return Z.prototype.load.call(this,a)}))};
h.sd=function(a){a=ke(this,a);this.zc=a.start;this.yc=a.end;this.W=this.zc;this.da=this.yc;this.g.Da&&re(this)};h.Ec=function(a){var b=ke(this,a);if(b){var c=this.da-this.yc;this.W=b.start+(this.W-this.zc);this.da=b.end+c}Z.prototype.Ec.call(this,a);this.Nc=!0;se(this);F(this.ea,this.video,"play",this.je.bind(this))};h.Hc=function(){te(this)||Z.prototype.Hc.call(this)};h.td=function(a){return(new Fd(a.toString())).send().then(D(this,function(a){var c=(new Id(this.fb)).Qa(a);this.Qc=a.Xa||0;return Promise.resolve(c)}))};
h.je=function(){te(this)};function te(a){var b=a.video.currentTime;if(b>=a.W-.01&&b<=a.da+.01)return!1;a.video.currentTime=b<a.W?a.W:a.da;return!0}h.me=function(a){qe(this);a=(Date.now()-a)/1E3;this.da-this.W+a>=this.Qc&&(this.W+=a);this.Nc?this.da+=a:1>=this.da-this.W&&(this.da=this.W+1);this.Nc&&se(this);re(this)};function se(a){var b=G({type:"seekrangechanged",bubbles:!0,start:a.W,end:a.da});a.dispatchEvent(b)}function re(a){a.bc=window.setTimeout(a.me.bind(a,Date.now()),1E3)}
function qe(a){a.bc&&(window.clearTimeout(a.bc),a.bc=null)};function $(a,b,c){b||(b=new Ia);c||(c=new Y);Z.call(this,null,b,c);this.ad=a;this.gc=[];this.timeoutMs=3E4}q($,Z);m("shaka.player.OfflineVideoSource",$);$.retrieveGroupIds=function(){var a=new Vb(null,null),b=Wb(a).then(function(){return Uc(a)});b.then(function(){P(a)}).catch(function(){P(a)});return b};
$.prototype.Oe=function(a,b,c,d){var e,f={},g=[];a=new Fd(a);var k=ya(b);return a.send().then(D(this,function(a){this.g=(new Id(c)).Qa(a);return this.g.Da?Promise.reject(Error("Unable to store live streams offline.")):Z.prototype.load.call(this,k)})).then(D(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.T);e=new zc(null,a,this);F(this.ea,e,"sessionReady",this.pe.bind(this));return Ac(e)})).then(D(this,function(){for(var a=ba(this.r),b=0;b<a.length;++b)for(var c=
a[b],e=0;e<c.e.length;++e){var g=c.e[e];f[g.I]=g}return d()})).then(D(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=f[c];if(d)g.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];g=g.filter(function(a){return 0>e.indexOf(a.n.split("/")[0])?!1:!0});a=g.map(function(a){return a.H.create()});return Promise.all(a)})).then(D(this,function(a){for(var b=g,c=[],d=0;d<b.length;++d)try{c[d]=this.T.addSourceBuffer(lc(b[d]))}catch(e){}if(b.length!=c.length)a=
Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(D(this,function(){return Dc(e,this.timeoutMs)})).then(D(this,function(){return ue(this,g,e.M,this.g.t[0].duration)}))};$.prototype.store=$.prototype.Oe;$.prototype.pe=function(a){this.gc.push(a.detail.sessionId)};
function ue(a,b,c,d){var e=new Vb(a.N,a),f=Wb(e);return f=f.then(D(a,function(){return Jc(e,b,this.gc,d,c)})).then(function(a){P(e);return Promise.resolve(a)}).catch(function(a){P(e);return Promise.reject(a)})}
$.prototype.load=function(a){var b=new Vb(null,null),c,d;return Wb(b).then(D(this,function(){return Tc(b,this.ad)})).then(D(this,function(a){var f=[];this.gc=a.session_ids;c=a.duration;d=a.key_system;for(var g=0;g<a.stream_ids.length;++g)f.push(Sc(b,a.stream_ids[g]));return Promise.all(f)})).then(D(this,function(b){var f=c,g=d,k=new qc;k.ba=5;for(var l=new pc,p=0;p<b.length;++p){var n=b[p],y=new jc,w=new Wc(n.references),x=new Uint8Array(n.init_segment),x=new L("data:application/octet-stream;base64,"+
oa(x)),x=new ic(new bc(x,0,null));y.G=w;y.H=x;y.n=n.mime_type;y.Y=n.codecs;n=new kb(g,"",!1,null);w=new mc;w.e.push(y);w.Ja.push(n);w.contentType=y.n.split("/")[0];l.u.push(w);l.duration=f}k.t.push(l);this.g=k;return Z.prototype.load.call(this,a)})).then(function(){P(b);return Promise.resolve()}).catch(function(a){P(b);return Promise.reject(a)})};
$.prototype.sc=function(){var a=new Vb(null,null);return Wb(a).then(a.sc.bind(a,this.ad)).then(function(){P(a);return Promise.resolve()}).catch(function(b){P(a);return Promise.reject(b)})};$.prototype.deleteGroup=$.prototype.sc;$.prototype.Sb=function(){return this.gc};$.prototype.Wb=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined")define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

